<html>
	<head>
		<title>GetURLSafeCharacters</title>
	</head>
	<body>
		<script>
			Array.prototype.contains = function(obj) {
				var i = this.length;
				while (i--) {
					if (this[i] === obj) {
						return true;
					}
				}
				return false;
			}
			
			function slowLoop(start, end, step, interval, content, contentParamsArr, passIteration) {
				var loopData = {i:start, step:step, end:end, content:content, params:contentParamsArr, iterationParams:[], passIteration:passIteration, loop:undefined};
				if (passIteration) {loopData.params.unshift();}
				if (start < end && step > 0) { //If looping forward
					var loop = setInterval(function(contentParamsArr) {
						if (loopData.i < loopData.end) {
							if (loopData.passIteration) {
								loopData.params[0] = loopData.i;
							}
							loopData.content.apply(this, loopData.params);
							loopData.i += loopData.step;
						} else {
							clearInterval(loop);
						}
					},interval,loopData);
					loopData.loop = loop;
				} else if (start > end && step < 0) { //If looping backward
					var loop = setInterval(function(contentParamsArr) {
						if (loopData.i > loopData.end) {
							if (loopData.passIteration) {
								loopData.params[0] = loopData.i;
							}
							loopData.content.apply(this, loopData.params);
							loopData.i += loopData.step;
						} else {
							clearInterval(loop);
						}
					},interval,loopData);
					loopData.loop = loop;
				} else { //Error
					console.log("The loop is invalid")
				}
			}
			
			
			var safes = ""
			var unsafes = "";
			var valid = [];
			var iteration;
			window.location.hash = "#";
			//for (var i = 32; i <= 99159; i++) {
			slowLoop(32, 99159+1, 1, 10, function(i) {
				var orig = String.fromCharCode(i);
				
				//	window.location.hash = "#" + orig;
				//	var tested = window.location.hash;
				//	var safe = false;
				//	document.iteration = i;
				//	if ("#" + orig === tested && !valid.contains(orig)) {
				//		safe = true;
				//		valid.push(orig);
				//		safes += orig;
				//	}
				//	console.log(i + ", " + safe + ", " + orig);
				
				document.iteration = i;
				var safe = false;
				if (!valid.contains(orig)) {
					safe = true;
					valid.push(orig);
					safes += orig;
				}
				console.log(i + ", " + safe + ", " + orig);
				
				i++;
			}, [], true);
			
			function Log() {
				return "\nCurrent index: " + iteration + "\nSafe characters so far: " + safes + "\nUnsafe characters so far: " + unsafes + "\n";
			}
		</script>
		
		<div id="safe">Safe:</div>
		<div style="position:relative;height:1000px"></div>
		<div id="unsafe">Unsafe:</div>
		
	</body>
</html>